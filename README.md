# TagZero - 纯前端数据标注工具

TagZero 是一个基于 Web 的本地优先数据标注工具，旨在提供轻量、高效的图像标注体验。用户直接打开浏览器即可使用，数据存储在本地浏览器内存/硬盘中（IndexedDB），不依赖后端服务。

## ✨ 已实现功能 (Features)

### 🎨 核心标注
- **多图形支持**：
  - 矩形 (Rectangle)
  - 圆形 (Circle)
  - 三角形 (Triangle)
  - 多边形 (Polygon)
- **画布交互**：
  - 基于 Konva.js 的高性能渲染。
  - 支持画布缩放 (Zoom) 与平移 (Pan)。
  - **智能边界限制**：防止图形在拖拽或调整大小时超出图片边界。
  - **图层管理**：选中对象自动置顶，避免遮挡，优化操作体验。
  - **顶点编辑**：支持多边形和三角形的顶点拖拽调整。
  - **辅助对齐**：支持拖拽时的**智能吸附**与**辅助线**显示，确保精准对齐。
- **局部放大镜**：
  - 支持 **Z 键** 快速切换放大镜模式，提供像素级细节查看。
  - **高度自定义**：支持放大倍数调整（1x - 16x）与镜框尺寸调整（200px - 600px）。
  - **智能交互**：
    - 放大镜自动避让屏幕边缘，防止遮挡。
    - 镂空准星设计，精准定位标注中心。
    - 支持实时同步显示所有标注图层与辅助线。

### 🏷️ 标签管理系统
- **配置管理**：支持创建、编辑、删除多组标签集 (Label Sets)。
- **持久化存储**：集成 **IndexedDB**，确保标签配置数据在页面刷新后不丢失。
- **自定义属性**：支持自定义标签名称与颜色（内置 64 种高对比度预设颜色）。
- **同步模式**：
  - **本地模式**：使用临时标签集，灵活添加。
  - **实时同步模式**：模拟远程同步，支持标签集的实时更新与锁定。
- **交互优化**：
  - 标签列表支持空状态下的默认引导。
  - 新增标签时的颜色自动去重/随机分配。

### 🖥️ UI/UX 体验
- **布局与工具栏优化**：
  - **工具栏左对齐**：操作按钮（撤销/重做、缩放）统一置于左侧，符合常见编辑器习惯。
  - **视觉升级**：
    - 统一按钮风格（白底灰边），去除不一致的样式。
    - 形状选择按钮默认仅展示图标（居中），悬停时显示名称，节省空间。
    - 修复按钮组间隙，采用无缝胶囊设计。
  - **全屏专注模式**：支持一键切换全屏，最大化工作区域，减少干扰。
  - **动态侧边栏**：
    - **拖拽调整宽度**：支持拖拽原始文件列表边缘调整宽度（窗口宽度的 10% - 16%）。
    - **视觉反馈**：鼠标悬停在侧边栏边缘时显示蓝色高亮线条，提示可调整状态。
    - **自适应列表项**：文件列表项大小随侧边栏宽度动态变化（宽高比 1:1），并优化了长文件名的显示（自动省略）。
- **画布交互升级**：
  - **智能缩放策略**：
    - 图片小于画布时：原尺寸居中显示，不拉伸。
    - 图片大于画布时：保持比例缩放至适配画布大小（Contain 模式），最大缩放比例限制为 1.0。
  - **平移控制**：支持在非标注区域**右键按住拖拽**移动整个画布。
  - **缩放同步**：放大、缩小、重置操作实时作用于当前画布状态。
  - **视觉优化**：画布区域增加 16px 内边距，避免内容贴边。
- **游戏化视觉反馈**：选中标注时显示“游戏风格”的水平浮动光标。
- **高效列表视图**：
  - 紧凑型标注列表，去除冗余边距，实现边缘对齐。
  - 选中项高亮与渐变背景效果。
- **文件处理**：支持多张图片及文件夹的本地加载（Blob URL 方案，无需上传服务器）。
- **交互优化**：
  - **防止无效数据**：自动过滤微小图形（矩形 < 5px / 圆形 < 3px），避免误触产生“幽灵”数据。
  - **边界安全**：严格限制锚点拖拽范围，确保所有操作点始终在图片区域内。

### 📤 数据导出与验证 (Export & Validation)
- **多格式支持**：
  - **TagZero JSON** (原生完整数据)
  - **COCO** (JSON)
  - **YOLO** (TXT + Images Zip)
  - **Pascal VOC** (XML + Images Zip)
- **智能校验**：
  - 导出前自动检测未标注图片。
  - **视觉警示**：未标注图片的序号背景自动变红，导出弹窗内展示未标注数量及具体序号列表（红色高亮提示），防止无效数据流出。

### ⌨️ 快捷键 (Shortcuts)
- **编辑 (Editing)**
  - `Delete` / `Backspace`: 删除选中标注 (Delete selected annotation)
  - `Ctrl + Z` / `Cmd + Z`: 撤销 (Undo)
  - `Ctrl + Shift + Z` / `Cmd + Shift + Z`: 重做 (Redo)
  - `Ctrl + S` / `Cmd + S`: 导出数据 (Export data)
- **导航 (Navigation)**
  - `A` / `←`: 上一张图片 (Previous image)
  - `D` / `→`: 下一张图片 (Next image)
- **工具切换 (Tools)**
  - `R`: 矩形工具 (Rectangle)
  - `C`: 圆形工具 (Circle)
  - `T`: 三角形工具 (Triangle)
  - `P`: 多边形工具 (Polygon)
- **画布控制 (Canvas Control)**
  - `Esc`: 取消绘制 / 取消选中 (Cancel drawing / Deselect)
  - `Ctrl/Cmd + +`: 放大 (Zoom In)
  - `Ctrl/Cmd + -`: 缩小 (Zoom Out)
  - `Ctrl/Cmd + 0`: 重置缩放 (Reset Zoom)
  - `Z`: 切换放大镜模式 (Toggle Magnifier)

## 📅 未来计划 (Roadmap)

### Phase 1: 基础完善 (Current Focus)
- [x] 核心图形绘制与编辑
- [x] 标签配置持久化 (IndexedDB)
- [x] 界面交互优化 (选中特效、列表对齐)
- [x] **数据导出**：支持标准格式 (COCO, Pascal VOC, YOLO) 导出。
- [x] **快捷键支持**：涵盖编辑、导航、工具切换、画布控制等全方位支持。

### Phase 2: 进阶体验
- [x] **撤销/重做 (Undo/Redo)**：实现完整的历史记录栈。
- [x] **辅助对齐**：绘制时的智能吸附与辅助线。
- [x] **放大镜工具**：细节标注时的局部放大功能。
- [ ] **多边形增强**：支持更复杂的顶点操作（增加/减少顶点）。

### Phase 3: 智能化与协作
- [ ] **AI 辅助标注**：接入 SAM (Segment Anything Model) 或其他轻量级模型进行前端推理。
- [ ] **后端集成**：提供 API 接口对接能力，支持云端存储与团队协作。
- [ ] **标注质检**：增加标注审核与自动检查流程。

### 🏗️ 代码重构 (Refactoring)
- **组件化架构**：
  - 将庞大的 `AnnotationView.vue` 拆分为独立且职责单一的子组件，统一管理于 `src/views/annotation/components/` 目录下：
    - `EditorToolbar.vue`: 顶部工具栏与操作逻辑。
    - `AnnotationCanvas.vue`: 核心画布交互与渲染。
    - `ImageList.vue`: 左侧原始文件列表与拖拽调整逻辑。
    - `AnnotationList.vue`: 右侧标注结果列表。
    - `LabelManager.vue`: 标签管理弹窗。
  - 优化了组件间的状态通信（使用 Pinia Store），提升了代码的可维护性与扩展性。
- **目录结构优化**：
  - 采用视图私有组件策略，将仅服务于标注页面的组件归档至 `src/views/annotation/components/`。
  - 优化模块引用路径，增强项目结构的清晰度。

## 🛠️ 技术栈 (Tech Stack)

- **Core**: Vue 3, TypeScript, Vite
- **State**: Pinia
- **UI**: Naive UI, Tailwind CSS (Utility classes)
- **Graphics**: Konva.js, vue-konva
- **Storage**: IndexedDB (idb wrapper)
- **I18n**: vue-i18n (中/英支持)

## 🚀 快速开始

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```
